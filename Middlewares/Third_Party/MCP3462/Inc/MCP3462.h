/*
 * MCP3462 Analog to Digital Converter driver
 *
 */

/* Define to prevent recursive inclusion -------------------------------------*/
#ifndef __MCP3462_H
#define __MCP3462_H


/* Registers */
enum MCP3492_Registers {
	ADCDATA=0,
	CONFIG0,
	CONFIG1,
	CONFIG2,
	CONFIG3,
	IRQ,
	MUX,
	SCAN,
	TIMER,
	OFFSETCAL,
	GAINCAL,
	RESERVED0,
	RESERVED1,
	LOCK,
	RESERVED2,
	CRCCFG };

/* Config0 bit definition */
/* Clock Selection */
#define MCP3462_CLK_INT_AMCLK	0b00110000
#define MCP3462_CLK_INT			0b00100000
#define MCP3462_CLK_EXT			0b00000000

/* Current Source */
#define MCP3462_Current15uA	0b00001100
#define MCP3462_Current3u7A	0b00001000
#define MCP3462_Current0u9A	0b00000100
#define MCP3462_CurrentNone	0b00000000

/* Operating Mode */
#define MCP3462_CONVERSION	0b00000011
#define MCP3462_STANDBY		0b00000010
#define MCP3462_SHUTDOWN	0b00000001
#define MCP3462_FORCE_SHUTDOWN	0b00000000


/* Config1 bit definition */
/* Prescaleer values for the analogue clock */
#define MCP3462_AMCLK_PRESCALE8	0b11000000
#define MCP3462_AMCLK_PRESCALE4	0b10000000
#define MCP3462_AMCLK_PRESCALE2	0b01000000
#define MCP3462_AMCLK_PRESCALE1	0b00000000

/* Oversampling Ratio */
#define MCP3462_OSR_98304	0b00111100
#define MCP3462_OSR_81920	0b00111000
#define MCP3462_OSR_49152	0b00110100
#define MCP3462_OSR_40960	0b00110000
#define MCP3462_OSR_24576	0b00101100
#define MCP3462_OSR_20480	0b00101000
#define MCP3462_OSR_16384	0b00100100
#define MCP3462_OSR_8192	0b00100000
#define MCP3462_OSR_4096	0b00011100
#define MCP3462_OSR_2048	0b00011000
#define MCP3462_OSR_1024	0b00010100
#define MCP3462_OSR_512		0b00010000
#define MCP3462_OSR_256		0b00001100
#define MCP3462_OSR_128		0b00001000
#define MCP3462_OSR_64		0b00000100
#define MCP3462_OSR_32		0b00000000

/* Config2 bit definition */
/* ADC Bias Current Selection */
#define MCP3462_BIAS_2		0b11000000
#define MCP3462_BIAS_1		0b10000000
#define MCP3462_BIAS_066	0b01000000
#define MCP3462_BIAS_050	0b00000000

/* ADC Gain Selection */
#define MCP3462_GAIN_64		0b00111000
#define MCP3462_GAIN_32		0b00110000
#define MCP3462_GAIN_16		0b00101000
#define MCP3462_GAIN_8		0b00100000
#define MCP3462_GAIN_4		0b00011000
#define MCP3462_GAIN_2		0b00010000
#define MCP3462_GAIN_1		0b00001000
#define MCP3462_GAIN_1_3	0b00000000

/* Auto-Zeroing Multiplier Setting */
#define MCP3462_AZ_MUX_ENABLED	0b00000100
#define MCP3462_AZ_MUX_DISABLED	0b00000000

/* Config3 bit definition */
/* Conversion Mode Selection */
#define MCP3462_MODE_CONTINUOUS			0b11000000
#define MCP3462_MODE_ONE_SHOT_STANDBY	0b10000000
#define MCP3462_MODE_ONE_SHOT_SHUTDOWN	0b01000000

/* ADC Output Data Format Selection */
#define MCP3462_FORMAT_32_17_D	0b00110000
#define MCP3462_FORMAT_32_17	0b00100000
#define MCP3462_FORMAT_32_16	0b00010000
#define MCP3462_FORMAT_16_16	0b00000000

/* CRC Checksum Format */
#define MCP3462_CRC16_32		0b00001000
#define MCP3462_CRC16_16		0b00000000

/* CRC Enable */
#define MCP3462_CRC_ENABLE		0b00000100
#define MCP3462_CRC_DISABLE		0b00000000

/* Offset Calibration Control */
#define MCP3462_OFFCAL_ENABLE	0b00000010
#define MCP3462_OFFCAL_DISABLE	0b00000000

/* ADC Operating Mode Selection */
#define MCP3462_GAINCAL_ENABLE	0b00000001
#define MCP3462_GAINCAL_DISABLE	0b00000000

/* Interrupt Request Register bit masks */
#define MCP3462_DATA_READY		0b01000000
#define MCP3462_CRCCFG			0b00100000
#define	POR				0b00010000
#define MCP3462_MDAT_IRQ		0b00001000
#define MCP3462_IRQ_STATE		0b00000100
#define MCP3462_FAST_COMMAND	0b00000010
#define MCP3462_START_INTERRUPT	0b00000001

/* Multiplier Register */
/* VIN+ */
#define MCP3462_VINPOS_INT			0b11110000
#define MCP3462_VINPOS_TEMP_M		0b11100000
#define MCP3462_VINPOS_TEMP_P		0b11010000
#define MCP3462_VINPOS_REFIN_NEG	0b11000000
#define MCP3462_VINPOS_REFIN_POS	0b10110000
#define MCP3462_VINPOS_AVdd			0b10010000
#define MCP3462_VINPOS_AGND			0b10000000
#define MCP3462_VINPOS_CH7			0b01110000
#define MCP3462_VINPOS_CH6			0b01100000
#define MCP3462_VINPOS_CH5			0b01010000
#define MCP3462_VINPOS_CH4			0b01000000
#define MCP3462_VINPOS_CH3			0b00110000
#define MCP3462_VINPOS_CH2			0b00100000
#define MCP3462_VINPOS_CH1			0b00010000
#define MCP3462_VINPOS_CH0			0b00000000

/* VIN- */
#define MCP3462_VINNEG_INT			0b00001111
#define MCP3462_VINNEG_TEMP_M		0b00001110
#define MCP3462_VINNEG_TEMP_P		0b00001101
#define MCP3462_VINNEG_REFIN_NEG	0b00001100
#define MCP3462_VINNEG_REFIN_POS	0b00001011
#define MCP3462_VINNEG_AVdd			0b00001001
#define MCP3462_VINNEG_AGND			0b00001000
#define MCP3462_VINNEG_CH7			0b00000111
#define MCP3462_VINNEG_CH6			0b00000110
#define MCP3462_VINNEG_CH5			0b00000101
#define MCP3462_VINNEG_CH4			0b00000100
#define MCP3462_VINNEG_CH3			0b00000011
#define MCP3462_VINNEG_CH2			0b00000010
#define MCP3462_VINNEG_CH1			0b00000001
#define MCP3462_VINNEG_CH0			0b00000000

/* Scan Modes Settings Register */
/* Delay Time between each conversion */
#define MCP3462_DMCLK512	0xE0000
#define MCP3462_DMCLK256	0xC0000
#define MCP3462_DMCLK128	0xA0000
#define MCP3462_DMCLK64		0x80000
#define MCP3462_DMCLK32		0x60000
#define MCP3462_DMCLK16		0x40000
#define MCP3462_DMCLK8		0x20000
#define MCP3462_DMCLK0		0x00000
// 89
/* SCAn channel selection */
#define MCP3462_ADC_OFFSET	0b0000000000001111

void MCP3462_ADCInit();	// Initialise the ADC
uint8_t MCP3462_ADCRead( int32_t *value, uint8_t *channel); // Perform a read of the ADC

#endif
